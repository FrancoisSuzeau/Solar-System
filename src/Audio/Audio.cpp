/*
AUTHOR : SUZEAU Fran√ßois

DATE : 27/05/2021

MODULE : Audio

NAMEFILE : Audio.h

PURPOSE :   - load music file
            - display file
            - change volume
            - pause/resume music
*/

#include "Audio.h"


/***********************************************************************************************************************************************************************/
/*********************************************************************** Constructor and Destructor ********************************************************************/
/***********************************************************************************************************************************************************************/
Audio::Audio(): m_volume(MIX_MAX_VOLUME / 2)
{
    m_file_music = {

        "../assets/audio/mass_effect.mp3",
        "../assets/audio/ArCorp_Theme.mp3",
        "../assets/audio/Space_Suit_generic3.mp3",
        "../assets/audio/The_darkness_SC.mp3",
        "../assets/audio/Into_the_void_SC.mp3",
        "../assets/audio/natural_splender.mp3"
    };
}

Audio::~Audio()
{
    Mix_FreeMusic(m_music);
}

/***********************************************************************************************************************************************************************/
/********************************************************************************* loadMusic ***************************************************************************/
/***********************************************************************************************************************************************************************/
bool Audio::loadMusic()
{
    /************************************************* load the file ********************************************************/
    m_music = Mix_LoadMUS(m_file_music[5].c_str());
    if(m_music == NULL)
    {
        std::cout << ">> Loading file music : ERROR : " << Mix_GetError() << std::endl;
        return false;
    }
    std::cout << ">> Loading file music : SUCCESS : " << m_file_music[5] << std::endl;
    //===================================================================================================================

    return true;

}

/***********************************************************************************************************************************************************************/
/********************************************************************************* manage music ************************************************************************/
/***********************************************************************************************************************************************************************/
void Audio::playMusic() const
{
    /************************************************* launch playlist ********************************************************/
    if(Mix_PlayMusic(m_music, -1) == -1)
    {
        std::cout << ">> Play music : ERROR : " << Mix_GetError() << std::endl;
    }
    //===================================================================================================================
}

void Audio::pause(bool pause) const
{
    if(pause)
    {
        if(Mix_PausedMusic() == 1)
        {
            Mix_ResumeMusic();
        }
        else
        {
            Mix_PauseMusic();
        }
    }
    
}

void Audio::volume(int change)
{
    if( (m_volume >= 0) && (m_volume <= 128) )
    {
        m_volume += change;
        Mix_VolumeMusic(m_volume);
    }
}